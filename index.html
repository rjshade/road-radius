<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
        html { height: 100% }
        body { height: 100%; margin: 0px; padding: 0px }
        #map_canvas { height: 80% }
    </style>

    <!--<script type="text/javascript"-->
        <!--src="http://code.google.com/apis/gears/gears_init.js">-->
    <!--</script>-->
    <script type="text/javascript"
        src="http://maps.google.com/maps/api/js?sensor=true">
    </script>

    <script type="text/javascript">

    var initialLocation;
    var oxford = new google.maps.LatLng(51.7573795, -1.2463022);
    var random = new google.maps.LatLng(31.7573795, -9.2463022);
    var map = NULL
    var directionsService = NULL
    var directionsRenderer = NULL

    // Try to geolocate to center initial map... if geolocation fails
    // then we default to centering on Oxford, England
    function initialize()
    {
        var mapOptions = {
                zoom: 9, //required
                center: oxford, //required
                mapTypeId: google.maps.MapTypeId.ROADMAP //required
        };

        var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
        directionService = new google.maps.DirectionsService();
        directionsRenderer = new google.maps.DirectionsRenderer({ map: map }); 
    
        if(navigator.geolocation)
        {
            navigator.geolocation.getCurrentPosition(gotGeolocation,noGeolocation,{'enableHighAccuracy':true,'timeout':5000,'maximumAge':0});
        }
        else
        {
            map.setCenter(oxford);
        }
    
        function gotGeolocation(pos)
        {
            var myLocation = new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude);
            map.setCenter(myLocation);
        }
        function noGeolocation(err)
        {
            map.setCenter(oxford);
        }
    }

    function route() {

      var newLatLng = google.maps.geometry.spherical.computeOffset( oxford, 30000, 45 )



      var request = {
        origin: document.getElementById("from").value,
        destination: newLatLng,
        travelMode: google.maps.DirectionsTravelMode.DRIVING
      }
      
      alert("making request..." + request.origin + "   " + request.destination);
      // Make the directions request
      directionService.route(request, function(result, status) {
        if (status == google.maps.DirectionsStatus.OK) {
          directionsRenderer.setDirections(result);
          
        } else {
          alert("Directions query failed: " + status);
        }
      });
    }
</script>
</head>

<body onload="initialize()">
    <div id="map_canvas" style="width:100%; height:80%"></div>
    <input type="text" id="from" value="oxford" />
    <input type="text" id="to" value="dunfermline" />
<input type="submit" onclick="route()"/> 
</body>
</html>
