<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
        html { height: 100% }
        body { height: 100%; margin: 0px; padding: 0px }
        #map_canvas { height: 100% }
    </style>

    <!--<script type="text/javascript"-->
        <!--src="http://code.google.com/apis/gears/gears_init.js">-->
    <!--</script>-->
    <script type="text/javascript"
        src="http://maps.google.com/maps/api/js?sensor=true">
    </script>

    <script type="text/javascript">

        var initialLocation;
        var siberia = new google.maps.LatLng(60, 105);
        var newyork = new google.maps.LatLng(40.69847032728747, -73.9514422416687);
        var browserSupportFlag =  new Boolean();

function gotPos(pos)
{
alert("got pos!" + pos.coords.latitude + " " +pos.coords.longitude);
}
function noPos(err)
{
alert("no pos :-(" );
}
        function initialize() {
            var myOptions = {
                zoom: 8, //required
                center: newyork, //required
                mapTypeId: google.maps.MapTypeId.ROADMAP //required
            };
            var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

                // Try W3C Geolocation (Preferred)
                if(navigator.geolocation) {
                  browserSupportFlag = true;
                alert("getting from browser...");
                  navigator.geolocation.getCurrentPosition(gotPos,noPos,{'enableHighAccuracy':true,'timeout':5000,'maximumAge':0});
                } else {
                  browserSupportFlag = false;
                  handleNoGeolocation(browserSupportFlag);
                }
                
                function handleNoGeolocation(errorFlag) {
                  if (errorFlag == true) {
                    alert("Geolocation service failed.");
                    initialLocation = newyork;
                  } else {
                    alert("Your browser doesn't support geolocation. We've placed you in Siberia.");
                    initialLocation = siberia;
                  }
                  map.setCenter(initialLocation);
                }
        }
    </script>
</head>

<body onload="initialize()">
    <div id="map_canvas" style="width:100%; height:100%"></div>
</body>
</html>
